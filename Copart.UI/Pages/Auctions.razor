@page "/auctions"
@using Copart.BLL.Models.LotModels
@inject ILotApi LotApi

<PageTitle>Auctions</PageTitle>

<MudDataGrid T="LotModel" Items="lots" Loading="isLoading">
    <Columns>
        <PropertyColumn Property="x => x.Id" Title="ID" />
        <PropertyColumn Property="x => x.LotNumber" Title="№ лота" />
        <PropertyColumn Property="x => x.StartDate" Title="Старт" />
        <PropertyColumn Property="x => x.EndDate" Title="Финиш" />
        <PropertyColumn Property="x => x.CurrentBid" Title="Тек. ставка" />
        <PropertyColumn Property="x => x.Vehicle.Model" Title="Модель" />
    </Columns>
</MudDataGrid>

@code {
    private List<LotModel> lots = new();
    private bool isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            var data = await LotApi.GetAll();
            lots = data.ToList();
        }
        catch (Exception ex)
        {
            Console.Error.WriteLine($"Error loading lots: {ex}");
        }
        finally
        {
            isLoading = false;
        }
    }
}
